<sequence xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" disabled="false" id="2ce73ddc-5591-41f8-afce-7921d373c4fa">
	<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="input/transactionId = null" id="da207ea8-963d-4c75-87d2-46daa7933eb7">
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="14d20b61-6bfc-401d-a5da-4e51346d1513" serviceId="nabu.utils.Transaction.start" resultName="result5061d92f1c7f4588a566e41928d678d0" invocationOrder="0" temporaryMapping="true" y="52" x="29">
			<asynchronous>false</asynchronous>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="98d5049a-4669-499a-b3ba-82ed2833dfb6" fixedValue="false" optional="false" mask="false">
			<from>result5061d92f1c7f4588a566e41928d678d0/transactionId</from>
			<to>input/transactionId</to>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="47e64de8-6d5e-4845-bcc8-ab6f2da321ca" fixedValue="true" optional="false" mask="false">
			<from>true</from>
			<to>manage</to>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="524d71f13d554179b270ddb961adde69">
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="4fdd877f9223407bad07ff6ad09b6999" serviceId="nabu.frameworks.tasks.services.task.start" resultName="resultf549fa54df464316907700d5717a10df" invocationOrder="0" temporaryMapping="true" y="59" x="51">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="557eebaf9cb14fffb9717e43576328a8" fixedValue="false" optional="false" mask="false">
				<from>input/connectionId</from>
				<to>connectionId</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="2ab6d212d02047089c5cf8d4615a719c" fixedValue="false" optional="false" mask="false">
				<from>input/task/id</from>
				<to>taskId</to>
			</steps>
			<asynchronous>false</asynchronous>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="9e5ee9835737467caf619c17bc664aed" fixedValue="false" optional="false" mask="false">
			<from>resultf549fa54df464316907700d5717a10df/started</from>
			<to>started</to>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="ae7b633a46214a9ba0696153d10b8857" fixedValue="true" optional="false" mask="false">
			<from>true</from>
			<to>chain</to>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Sequence" disabled="false" label="started" comment="Only execute if we started it, it may have been started by another server in the mean time" id="09c4f976646a4ba1ac26d0c3b9c24304">
		<steps xsi:type="be.nabu.libs.services.vm.step.Switch" disabled="false" label="input/task/taskInput != null" id="c9de4bc6-2053-47c1-b876-e43ce8faed0a">
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="input/task/taskInput ~ &quot;(?s)^&lt;.*&quot;" comment="Its xml" id="133b9cc1-a720-4e95-8f54-173d7d9dc024">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="d6f7bbb6-70ec-4cad-a07e-4b5183103839" serviceId="nabu.utils.reflection.Service.newServiceInput" resultName="resultca2b1865e71f4147bd441319232d5b4d" invocationOrder="1" temporaryMapping="true" y="171" x="239">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="6ecfd5fc-b241-4db8-a572-cae1b3cf4918" fixedValue="false" optional="false" mask="false">
						<from>result08c5aa686a51476f9695c159ff7622a4/stream</from>
						<to>content</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="9cab0007-c05e-4899-a97b-475928d0f479" fixedValue="false" optional="false" mask="false">
						<from>input/task/task</from>
						<to>serviceId</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="a511a055-9ab2-4e51-a67b-7909ec6d3bef" fixedValue="true" optional="false" mask="false">
						<from>UTF-8</from>
						<to>charset</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="725fea05-2e89-408d-90b5-af7115398992" serviceId="nabu.utils.String.toStream" resultName="result08c5aa686a51476f9695c159ff7622a4" invocationOrder="0" temporaryMapping="true" y="90" x="23">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="c23d4916-42c2-4e9f-ad86-aca44428c483" fixedValue="false" optional="false" mask="false">
						<from>input/task/taskInput</from>
						<to>string</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="6f5b3d72-c314-4d05-9931-bd373ef0ddc9" fixedValue="true" optional="false" mask="false">
						<from>UTF-8</from>
						<to>charset</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="b6881f03-cd1d-44f0-bbe9-03895df3726d" fixedValue="false" optional="false" mask="false">
					<from>resultca2b1865e71f4147bd441319232d5b4d/typeInstance</from>
					<to>serviceInput</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="6de2c6e9-cc48-4fb0-80cb-ab5d74cba151" fixedValue="true" optional="false" mask="false">
					<from>true</from>
					<to>useXml</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Its a datastore URI" id="3c86824fc22f454f9675c3b0ec722ef5">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="2f5d2aafdcdc475d93155e9fe724011d" serviceId="nabu.frameworks.datastore.Services.retrieve" resultName="result47dd0191d8b34095854f4bfa18a9def7" invocationOrder="0" temporaryMapping="true" y="81" x="31">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="e1c91e5de00441d3bf2ce318d3ccd756" fixedValue="false" optional="false" mask="false">
						<from>input/task/taskInput</from>
						<to>uri</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="22887cef8170409288b78da64b5fa602" serviceId="nabu.utils.reflection.Service.newServiceInput" resultName="result2ac1d134177d41faa0e7d15b6edb86bd" invocationOrder="1" temporaryMapping="true" y="204" x="195">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="557a13ec3927425dbe8605ea05fc6cc4" fixedValue="false" optional="false" mask="false">
						<from>result47dd0191d8b34095854f4bfa18a9def7/stream</from>
						<to>content</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="9f3009fcb9b74065af96e86027638bde" fixedValue="false" optional="false" mask="false">
						<from>input/task/task</from>
						<to>serviceId</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="be99551a1bab4475bac52e347e558f17" fixedValue="true" optional="false" mask="false">
						<from>UTF-8</from>
						<to>charset</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="b5139fc0adfb48058bc43ea7f2598450" fixedValue="false" optional="false" mask="false">
					<from>result2ac1d134177d41faa0e7d15b6edb86bd/typeInstance</from>
					<to>serviceInput</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="d10cc787-fb33-487b-b91c-0f523a92124e" fixedValue="true" optional="false" mask="false">
					<from>false</from>
					<to>useXml</to>
				</steps>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Switch" disabled="false" id="92e12f0c-d53e-4107-8d6a-679f8b57872a" query="input/task/serviceContext">
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="null" comment="Set service context" id="58d8eb20-b91f-4bf6-a072-48fb364a8b14">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="3a0e724c-d97d-4b5e-823d-cd0f47a5e1a2" serviceId="nabu.utils.Runtime.setServiceContext" resultName="resultdae0991bee3b42da8a26e44951466eb9" invocationOrder="0" temporaryMapping="true" y="98" x="26">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="7258796d-86ef-49d6-82f7-4692d292e609" fixedValue="false" optional="false" mask="false">
						<from>input/task/task</from>
						<to>context</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Set service context" id="6577e5bf4d4d4888a645563d8b2c9925">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="113d92cec51e4aef972b71d5f7b42413" serviceId="nabu.utils.Runtime.setServiceContext" resultName="resultdae0991bee3b42da8a26e44951466eb9" invocationOrder="0" temporaryMapping="true" y="98" x="26">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="58762eaf-6b02-4a82-9809-83e81c5cc669" fixedValue="false" optional="false" mask="false">
						<from>input/task/serviceContext</from>
						<to>context</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="cd078c49092f42ffa97747f138cbdba2">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="17499f5499c74db6a3e9c1c7793f61da" serviceId="nabu.utils.reflection.Service.invoke" resultName="result3a0c1cf083b24939adce56117e8e84cd" invocationOrder="0" temporaryMapping="true" y="86" x="32">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="e25a1340624149978e09e9044f630f81" fixedValue="false" optional="false" mask="false">
					<from>input/task/task</from>
					<to>serviceId</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="5266a67323be4629a09487b369fcd2b8" fixedValue="false" optional="false" mask="false">
					<from>serviceInput</from>
					<to>input</to>
				</steps>
				<asynchronous>false</asynchronous>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="b12a63673318466397144444cfa2aa2f" fixedValue="false" optional="false" mask="false">
				<from>result3a0c1cf083b24939adce56117e8e84cd/output</from>
				<to>serviceOutput</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Sequence" disabled="false" label="serviceOutput" comment="Serialize the output" id="25f0b7c8-083f-4f45-8ffa-81998f75199f">
			<steps xsi:type="be.nabu.libs.services.vm.step.Switch" disabled="false" id="da9a9021-7f16-4fab-9bfe-011d3c93f941" query="useXml">
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="false" id="f39adacf4e584173a9ec61faa87a9623">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="8fa37f3bc74c42a4b684da158e3886e7" serviceId="nabu.data.xml.Services.store" resultName="resultbe46f47bb42b4389bb85e1c6f555f8c0" invocationOrder="0" temporaryMapping="true" y="57" x="23">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="8bf7225e9de04d32bea808c1208b3231" fixedValue="false" optional="false" mask="false">
							<from>serviceOutput</from>
							<to>data</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="dd7a456b36454b6e8a536894f1db231b" fixedValue="true" optional="false" mask="false">
							<from>UTF-8</from>
							<to>charset</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="c791b010f504471187b8f3bd740eb3fc" fixedValue="false" optional="false" mask="false">
						<from>resultbe46f47bb42b4389bb85e1c6f555f8c0/uri</from>
						<to>taskOutput</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="e2278acb-3823-4f3f-b0bb-cbfda63790be">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="fa46fdc0-9c27-49b2-b7eb-58cbe9e6514f" serviceId="nabu.data.xml.Services.marshal" resultName="resultd0e595ff7ed44d96910e032c226b093f" invocationOrder="0" temporaryMapping="true" y="56" x="66">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="7dc45135-e347-4606-9593-77e6a9acd2f0" fixedValue="false" optional="false" mask="false">
							<from>serviceOutput</from>
							<to>data</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="f2bf4af6-b052-43a3-b003-54b6d7e0bf3d" fixedValue="true" optional="false" mask="false">
							<from>UTF-8</from>
							<to>charset</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="9f4f8561-13b1-43c6-bb6b-5e1830840f46" serviceId="nabu.utils.Stream.toString" resultName="result227504bbaf9e413cb3d6fdab6418d573" invocationOrder="1" temporaryMapping="true" y="251" x="390">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="2e1089b5-2b15-400c-be1c-781e9363b681" fixedValue="false" optional="false" mask="false">
							<from>resultd0e595ff7ed44d96910e032c226b093f/marshalled</from>
							<to>stream</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="36c00f1d-2d29-42b0-86fc-2755fcd3448c" fixedValue="true" optional="false" mask="false">
							<from>UTF-8</from>
							<to>charset</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="32def30e-9482-406a-9adc-8174c59a3a0a" fixedValue="false" optional="false" mask="false">
						<from>result227504bbaf9e413cb3d6fdab6418d573/string</from>
						<to>taskOutput</to>
					</steps>
				</steps>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="715e9c6b90c74914bcc1f7e1c85d030b">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="908c2d5bab5d4cd1a365493d72536df4" serviceId="nabu.frameworks.tasks.services.task.stop" resultName="result12b7fa96233b4d94a4414b9647fc2fa3" invocationOrder="0" temporaryMapping="true" y="54" x="25">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="271f3e9ad7ab489ca005aeeb5df9d968" fixedValue="false" optional="false" mask="false">
					<from>input/connectionId</from>
					<to>connectionId</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="092d41094e3a49e7b3661164d920afbe" fixedValue="false" optional="false" mask="false">
					<from>input/transactionId</from>
					<to>transactionId</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="627af30709e5423bab6ddf9d6b34330c" fixedValue="false" optional="false" mask="false">
					<from>input/task/id</from>
					<to>taskId</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="cd2deb34-9bde-455b-8d4e-0a0a96a25459" fixedValue="false" optional="false" mask="false">
					<from>taskOutput</from>
					<to>taskOutput</to>
				</steps>
				<asynchronous>false</asynchronous>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="2a82c5b83d1d40738cd6457599b492f2" fixedValue="false" optional="false" mask="false">
				<from>result12b7fa96233b4d94a4414b9647fc2fa3/stopped</from>
				<to>stopped</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Throw" disabled="false" label="!stopped" id="85c48b56374a404bb3ec5706b132a831" message="=&quot;Could not stop task: &quot; + input/task/id" xsi:nil="true"/>
		<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="true" comment="Chain a new task for this queue if possible" id="5c06566078c84d3f89b4f02728954375">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="819eedc3957c49b3b2cca1ed3ed67547" serviceId="nabu.frameworks.tasks.utils.queue.subscribe" resultName="result3669c172fe714379a100041bc06cbb51" invocationOrder="0" temporaryMapping="true" y="48" x="45">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="ec59a4bcc94f4431bfc610f2fe230ac8" fixedValue="false" optional="false" mask="false">
					<from>input/connectionId</from>
					<to>connectionId</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="9cbc38de8e1448a1abf0afc73d37e77e" fixedValue="false" optional="false" mask="false">
					<from>input/transactionId</from>
					<to>transactionId</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="0c8c4efca8574d4ba1941bbea4be7b82" fixedValue="false" optional="false" mask="false">
					<from>input/queue</from>
					<to>queue</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="31e3652c0826478ca1906752a9e7d86c" fixedValue="false" optional="false" mask="false">
					<from>input/localLock</from>
					<to>localLock</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="736612c68e52483eb8c4d14dcf7ee780" fixedValue="false" optional="false" mask="false">
					<from>input/targets</from>
					<to>targets</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="644d2b1e76184ab29816e7346db7c0e9" fixedValue="false" optional="false" mask="false">
					<from>input/taskType</from>
					<to>taskType</to>
				</steps>
				<asynchronous>false</asynchronous>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="a0cef625505348f0ad2b16c7745f4bb1" serviceId="nabu.utils.List.size" resultName="resulte2d123fda7794f349c6261a8b59e165e" invocationOrder="1" temporaryMapping="true" y="200" x="228">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="b949a247e8124a92acf88ca7ab8c4677" fixedValue="false" optional="false" mask="false">
					<from>result3669c172fe714379a100041bc06cbb51/tasks</from>
					<to>list</to>
				</steps>
				<asynchronous>false</asynchronous>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="038afcc26a594722b1e9e559a36db9e8" fixedValue="false" optional="false" mask="false">
				<from>resulte2d123fda7794f349c6261a8b59e165e/size</from>
				<to>amountOfRescheduledTasks</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="true" label="amountOfRescheduledTasks = 0" comment="If we could not reschedule a task, check that the queue is done" id="f71cecd628634124a1d9b90c8d8a9584">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="372d50f1d0064d8f8ccb68d24691359d" serviceId="nabu.frameworks.tasks.utils.queue.checkFinished" resultName="result99f2059a50a8438e9f74898e759d2703" invocationOrder="0" temporaryMapping="true" y="85" x="40">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="84e79287b86a41d484ab0119b9fb3236" fixedValue="false" optional="false" mask="false">
					<from>input/connectionId</from>
					<to>connectionId</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="0a8a4cde06724951924a7bc33698cf89" fixedValue="false" optional="false" mask="false">
					<from>input/transactionId</from>
					<to>transactionId</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="b92ed2e1a71d46189ee96c83f6c2ebdc" fixedValue="false" optional="false" mask="false">
					<from>input/queue</from>
					<to>queue</to>
				</steps>
				<asynchronous>false</asynchronous>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Catch" disabled="false" id="722bfa3c09fd4e8696fcb8971b6eb6b6" variable="exception">
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Summarize exception" id="21f06c17a22b424aacf16a2a90e90820">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="127b2b781a834270afb9dbd9ff6a4b9a" serviceId="nabu.utils.Runtime.summarizeException" resultName="result6c61a1da4ba9459d9352d7d20bb5f1cc" invocationOrder="0" temporaryMapping="true" y="205" x="77">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="3bfe1d042cff4836a6792da7cfaaf71e" fixedValue="false" optional="false" mask="false">
						<from>exception</from>
						<to>exception</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="00457eea49124b759d063279540f16b5" fixedValue="false" optional="false" mask="false">
					<from>result6c61a1da4ba9459d9352d7d20bb5f1cc/summary</from>
					<to>summary</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="23934fb822434a3fb32876c1e1f29969" fixedValue="true" optional="false" mask="false">
					<from>false</from>
					<to>chain</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Try to classify the error" id="437dc6c1-0208-4155-b9e3-434488f7b9fa">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="b8655ac2-61dd-4397-a6c2-42ecd91258e9" serviceId="nabu.frameworks.tasks.utils.task.classify" resultName="resultfde8fa1afee34729a4e0b2eb59cbcfd8" invocationOrder="0" temporaryMapping="true" y="63" x="62">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="3ebe6e85-948a-4866-a405-b2f2883fb60b" fixedValue="false" optional="false" mask="false">
						<from>input/connectionId</from>
						<to>connectionId</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="464b2bb3-886b-4cda-9b8e-949e30df4cb3" fixedValue="false" optional="false" mask="false">
						<from>summary/exceptionStack</from>
						<to>stacktrace</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="7fd93a87-dd0d-4dad-8742-20a7ea98a335" fixedValue="false" optional="false" mask="false">
						<from>summary/code</from>
						<to>code</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="1dcf1e6d-aa21-4b3d-88ba-8fdfcbc7dbd6" fixedValue="false" optional="false" mask="false">
						<from>input/task/id</from>
						<to>taskId</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="348fb35c-ee1d-4df3-a15a-07cc56830bfb" fixedValue="false" optional="false" mask="false">
					<from>resultfde8fa1afee34729a4e0b2eb59cbcfd8/transient</from>
					<to>classification/transient</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="94ea60c2-65b9-4002-a0b5-dd491bb8fafe" fixedValue="false" optional="false" mask="false">
					<from>resultfde8fa1afee34729a4e0b2eb59cbcfd8/code</from>
					<to>classification/code</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="508afddc-e2a8-48dd-ab52-0d2a42525bf0" fixedValue="false" optional="false" mask="false">
					<from>resultfde8fa1afee34729a4e0b2eb59cbcfd8/message</from>
					<to>classification/message</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="9cdeb495-7f89-4494-aa5d-7a8250bc5e6f" fixedValue="false" optional="false" mask="false">
					<from>resultfde8fa1afee34729a4e0b2eb59cbcfd8/retryInterval</from>
					<to>classification/retryInterval</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="474f60f1-3af9-47d6-914a-a124272c9a45" fixedValue="false" optional="false" mask="false">
					<from>resultfde8fa1afee34729a4e0b2eb59cbcfd8/fail</from>
					<to>classification/fail</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="classification/code != null" comment="If you set a custom code, use that" id="853434aa-9dac-47bc-ae0e-cf28d4f46c02">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="dbc63c66-db6c-45c6-985f-cb93a6366b67" fixedValue="false" optional="false" mask="false">
					<from>classification/code</from>
					<to>summary/code</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="classification/message != null" comment="If you set a custom message, use that" id="6b0380dadb974c56b0371e3c0e1572e1">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="7f965d4e-e492-41db-b6bc-33a44b596555" fixedValue="false" optional="false" mask="false">
					<from>classification/message</from>
					<to>summary/message</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="summary/code = null" comment="Set default code" id="d6a2a976-1f5e-4dec-9620-2bd543b14e78">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="77d4fa32-c8dc-4d14-ab82-f794c62fcb39" fixedValue="true" optional="false" mask="false">
					<from>unknown</from>
					<to>summary/code</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Stop task" id="ce1b5e86112f467f864ff8f388b20e10">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="9e2b576690f5490e873eec81293c7256" serviceId="nabu.frameworks.tasks.services.task.stop" resultName="result3e64c094658c4170993ba08b8fdf589c" invocationOrder="0" temporaryMapping="true" y="67" x="68">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="656f862c4bfc469da96401741d52db23" fixedValue="false" optional="false" mask="false">
						<from>input/connectionId</from>
						<to>connectionId</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="107ab82afcda4d22b60a85e9f128de56" fixedValue="false" optional="false" mask="false">
						<from>input/task/id</from>
						<to>taskId</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="ce5a28245e994bea8ce76c84349e9d47" fixedValue="false" optional="false" mask="false">
						<from>taskOutput</from>
						<to>taskOutput</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="bfab0dc597d4457295dcbdb89daa4564" fixedValue="true" optional="false" mask="false">
						<from>=summary/serviceStack + "\n\n" + summary/exceptionStack</from>
						<to>errorDescription</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="11619a99c8884fcdb44de46ae590f242" fixedValue="false" optional="false" mask="false">
						<from>summary/message</from>
						<to>errorMessage</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="74d5e8d236934e3f8b379f2c39fc9b6c" fixedValue="false" optional="false" mask="false">
						<from>summary/code</from>
						<to>code</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="82ff8b7f-5827-405f-a375-64f722909b4f" fixedValue="false" optional="false" mask="false">
						<from>classification/transient</from>
						<to>transient</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="776470a2-d79f-4a1e-9f08-c057e9fad78d" fixedValue="false" optional="false" mask="false">
						<from>classification/fail</from>
						<to>fail</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="input/queue/concurrency = 0 &amp;&amp; !classification/fail" comment="Pause queue if it is a serial queue and we did not set it immediately to failed" id="ada782615dea4e5db077ddc876f99376">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="4301bfcad3ae4bcd8df9dd0797f0a1ca" serviceId="nabu.frameworks.tasks.database.taskQueue.pauseQueue" resultName="result64f108a898f04ee2b4f6b060a8119aeb" invocationOrder="0" temporaryMapping="true" y="88" x="52">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="19f9b15467404587b228c17fc38aef2f" fixedValue="false" optional="false" mask="false">
						<from>input/queue/id</from>
						<to>parameters[0]/queueId</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="499db2fb7cb842e78c8a2198fbc212cc" fixedValue="false" optional="false" mask="false">
						<from>input/connectionId</from>
						<to>connection</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="171a58b5db49484180b634f67fa707a6" fixedValue="false" optional="false" mask="false">
						<from>input/transactionId</from>
						<to>transaction</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Send notification" id="3fecf172-6d82-451f-bc9c-15c0ddec3c89">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="cfc683de-66ca-4771-b137-410d779535d8" serviceId="nabu.frameworks.notifier.Services.notify" resultName="result20012d3c464d488aafa5548073a35fd7" invocationOrder="0" temporaryMapping="true" y="113" x="33">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="b3eef68b-1752-4400-95c7-5158651d77e9" fixedValue="false" optional="false" mask="false">
						<from>summary/message</from>
						<to>message</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="547f265c-4300-4d56-8ab4-2ac7676f56d8" fixedValue="true" optional="false" mask="false">
						<from>="nabu.frameworks.tasks:" + summary/code</from>
						<to>type</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="a463c0bd-ac8a-41f4-919c-6eed39c215c3" fixedValue="true" optional="false" mask="false">
						<from>ERROR</from>
						<to>severity</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="4ae94c74-ded4-4359-87b9-9349e21c37be" fixedValue="false" optional="false" mask="false">
						<from>input/queue/name</from>
						<to>context[0]</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="3ba0b415-b954-40ec-b3ab-aaf4afb24643" fixedValue="false" optional="false" mask="false">
						<from>classification</from>
						<to>properties</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="781bf603-189a-4f16-a48f-cef64ea38f16" fixedValue="true" optional="false" mask="false">
						<from>=summary/serviceStack + "\n\n" + summary/exceptionStack</from>
						<to>description</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Sequence" disabled="false" label="classification/retryInterval != null" comment="Retry the task" id="e22145a2-b78a-4cf6-b56f-91ee1937ecb7">
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Get run date" id="23ff9274-5a7d-49c6-8f79-389f45b4eac7">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="0508ae92-ba0e-49f3-98ec-402389007fd3" serviceId="nabu.utils.Date.increment" resultName="result4381eb98595343979d3f4c87a79961b5" invocationOrder="0" temporaryMapping="true" y="83" x="76">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="93fa036f-e124-4922-9570-421c72e01284" fixedValue="false" optional="false" mask="false">
							<from>classification/retryInterval</from>
							<to>increment</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="6dfc8215-09f5-4c07-81f5-3341d4a95fa5" fixedValue="true" optional="false" mask="false">
							<from>MILLISECONDS</from>
							<to>unit</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="866f4957-50fd-4049-a701-effc509fe416" fixedValue="false" optional="false" mask="false">
						<from>result4381eb98595343979d3f4c87a79961b5/date</from>
						<to>classification/runAt</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="ea89d67c-05de-483f-a7c3-33498d367fe8">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="abfa6dba-5d3e-4d4d-baca-8b0bd7929a48" serviceId="nabu.frameworks.tasks.utils.task.retry" resultName="result29aa9206a133474ba25c66677d5ad90f" invocationOrder="0" temporaryMapping="true" y="48" x="83">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="bdb6bc81-ab2f-4254-a97d-cd222262df21" fixedValue="false" optional="false" mask="false">
							<from>input/connectionId</from>
							<to>connectionId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="ff2a67d9-309d-4676-9d07-aeead7003c81" fixedValue="false" optional="false" mask="false">
							<from>input/targets</from>
							<to>targets</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="25ad10d3-75c0-4b6d-9537-fb1602e70c92" fixedValue="false" optional="false" mask="false">
							<from>input/taskType</from>
							<to>taskType</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="225440e9-14fa-465c-b825-805b3b7ddfd8" fixedValue="false" optional="false" mask="false">
							<from>input/queue/id</from>
							<to>queueId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="6fcdb95b-9865-4f3e-83aa-935d182e553f" fixedValue="false" optional="false" mask="false">
							<from>input/task/id</from>
							<to>taskId</to>
						</steps>
						<targetProperties collectionIndex="runAt">=classification/runAt</targetProperties>
						<asynchronous>false</asynchronous>
						<target>nabu.frameworks.tasks.providers.executor</target>
					</steps>
				</steps>
			</steps>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="true" comment="Lock locally" id="e6fce3f7-36b5-4371-8786-ce27ace38151">
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="551b4e50-8b17-4de2-aa10-968f0be47fe1" serviceId="nabu.utils.Lock.lock" resultName="resulte45e6f7510e94dfb8f48a19b6501e4b1" invocationOrder="0" temporaryMapping="true" y="74" x="49">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="582c3b5c-3598-488c-846c-fb5c0e298c37" fixedValue="false" optional="false" mask="false">
				<from>input/localLock</from>
				<to>name</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="fdd4f5f7-4f5e-4ab7-9c2c-47a607f56435" fixedValue="true" optional="false" mask="false">
				<from>true</from>
				<to>local</to>
			</steps>
			<asynchronous>false</asynchronous>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Sequence" disabled="true" comment="Make sure we unlock local lock" id="302e5123-46cb-4abb-9de3-141bab84c6f0">
		<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="input/clusterLock != null" comment="Lock cluster-wide if necessary" id="ca2f9f41-6a4c-4fb1-a31d-318be1e2e92d">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="2e4945ac-3d40-4097-8efc-f6775528cd25" serviceId="nabu.utils.Lock.lock" resultName="result1d5840816bb94d5aa48b86be13e36ac4" invocationOrder="0" temporaryMapping="true" y="51" x="60">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="748ced2e-92e3-4522-8c99-62afb5a19f1a" fixedValue="false" optional="false" mask="false">
					<from>input/clusterLock</from>
					<to>name</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="49e6f8e3-f9ce-4bed-bd6d-0d2c093ea6b4" fixedValue="true" optional="false" mask="false">
					<from>false</from>
					<to>local</to>
				</steps>
				<asynchronous>false</asynchronous>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Sequence" disabled="false" comment="Make sure we unlock the global lock" id="5b5054e2-b82f-47ae-825a-ab734da7035e">
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="36ce0b8d-9fe8-483b-ae18-cd7aba073817">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="f87e4268-73c6-4e89-90da-583b854f0dc7" serviceId="nabu.frameworks.tasks.services.task.start" resultName="resultf549fa54df464316907700d5717a10df" invocationOrder="0" temporaryMapping="true" y="59" x="51">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="c655498b-7adb-459a-b29f-ff57b5ab772f" fixedValue="false" optional="false" mask="false">
						<from>input/connectionId</from>
						<to>connectionId</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="36ddf2a7-36fb-4a94-bfe0-fb2fade49702" fixedValue="false" optional="false" mask="false">
						<from>input/task/id</from>
						<to>taskId</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="6596c100-339e-4344-910a-06708e493a21" fixedValue="false" optional="false" mask="false">
					<from>resultf549fa54df464316907700d5717a10df/started</from>
					<to>started</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="23a3dc5a-c23f-4554-a248-9ca13d9d4d03" fixedValue="true" optional="false" mask="false">
					<from>true</from>
					<to>chain</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Sequence" disabled="false" label="started" comment="Only execute if we started it, it may have been started by another server in the mean time" id="32a1d366-8fbf-43cb-8a9f-17ca832c0664">
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="input/task/taskInput != null" id="7d97130e-2174-4f01-b604-75ed61a75ccd">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="3b857a4c-9687-43ef-a027-cd20ad6815a1" serviceId="nabu.frameworks.datastore.Services.retrieve" resultName="result47dd0191d8b34095854f4bfa18a9def7" invocationOrder="0" temporaryMapping="true" y="81" x="31">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="e5c5c180-29ab-4fce-a9ce-4da743f60c12" fixedValue="false" optional="false" mask="false">
							<from>input/task/taskInput</from>
							<to>uri</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="3bf1e860-2a7d-47b1-baf9-47f7712f853f" serviceId="nabu.utils.reflection.Service.newServiceInput" resultName="result2ac1d134177d41faa0e7d15b6edb86bd" invocationOrder="1" temporaryMapping="true" y="204" x="195">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="75836c32-e26d-4f49-a004-a8a8feb0b85e" fixedValue="false" optional="false" mask="false">
							<from>result47dd0191d8b34095854f4bfa18a9def7/stream</from>
							<to>content</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="f8281fff-6a36-4030-80d7-868300c3df03" fixedValue="false" optional="false" mask="false">
							<from>input/task/task</from>
							<to>serviceId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="97d80d97-e51a-4024-b87c-14f7ebdc67bd" fixedValue="true" optional="false" mask="false">
							<from>UTF-8</from>
							<to>charset</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="72f13577-543b-4c12-8f81-70f1be94a17c" fixedValue="false" optional="false" mask="false">
						<from>result2ac1d134177d41faa0e7d15b6edb86bd/typeInstance</from>
						<to>serviceInput</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="c5154573-e7b8-4252-90cf-cef4a43013a4">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="aac8bfa6-ffc1-44c5-b850-afe0a611f3e1" serviceId="nabu.utils.reflection.Service.invoke" resultName="result3a0c1cf083b24939adce56117e8e84cd" invocationOrder="0" temporaryMapping="true" y="86" x="32">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="b621e076-fa9e-494c-9cf8-142f23a3a835" fixedValue="false" optional="false" mask="false">
							<from>input/task/task</from>
							<to>serviceId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="c3163073-2bd5-469f-bb0f-d2507426c5a6" fixedValue="false" optional="false" mask="false">
							<from>serviceInput</from>
							<to>input</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="beec6a41-bfb2-4a63-a963-6a9e5e7598b4" fixedValue="false" optional="false" mask="false">
						<from>result3a0c1cf083b24939adce56117e8e84cd/output</from>
						<to>serviceOutput</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="serviceOutput" id="8c3c38c3-8b0a-4771-9f63-301356ccdebe">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="d3a6a8b1-6e11-4339-bdc7-3cad9adf651d" serviceId="nabu.data.xml.Services.store" resultName="resultbe46f47bb42b4389bb85e1c6f555f8c0" invocationOrder="0" temporaryMapping="true" y="57" x="23">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="84355e79-2239-4aad-b147-30ce075379ae" fixedValue="false" optional="false" mask="false">
							<from>serviceOutput</from>
							<to>data</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="5dae8382-7f34-4d2d-8e57-2aebf484220e" fixedValue="true" optional="false" mask="false">
							<from>UTF-8</from>
							<to>charset</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="a56784ea-9b61-44e4-8e86-9833d633d378" fixedValue="false" optional="false" mask="false">
						<from>resultbe46f47bb42b4389bb85e1c6f555f8c0/uri</from>
						<to>taskOutput</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="612f9e1f-f4e6-4667-bcef-2076aa636551">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="a782f80d-43ba-47f1-86a5-47850cd620d3" serviceId="nabu.frameworks.tasks.services.task.stop" resultName="result12b7fa96233b4d94a4414b9647fc2fa3" invocationOrder="0" temporaryMapping="true" y="54" x="25">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="a4448489-28ba-46e0-b241-8eed4e93fae4" fixedValue="false" optional="false" mask="false">
							<from>input/connectionId</from>
							<to>connectionId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="8600fb8d-d13e-43ff-914b-e9d7b6e7f361" fixedValue="false" optional="false" mask="false">
							<from>input/transactionId</from>
							<to>transactionId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="46f5f455-45fb-46bc-8f84-df47ec2bd3d2" fixedValue="false" optional="false" mask="false">
							<from>input/task/id</from>
							<to>taskId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="17ff7f24-a344-4d7e-b575-4408ae5528ca" fixedValue="false" optional="false" mask="false">
							<from>taskOutput</from>
							<to>taskOutput</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="1b9a9290-55f1-46ba-8406-aba1a2d6a358" fixedValue="false" optional="false" mask="false">
						<from>result12b7fa96233b4d94a4414b9647fc2fa3/stopped</from>
						<to>stopped</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Throw" disabled="false" label="!stopped" id="8f0f4b4e-6353-46b8-aa9e-25f04155604b" message="=&quot;Could not stop task: &quot; + input/task/id" xsi:nil="true"/>
				<steps xsi:type="be.nabu.libs.services.vm.step.Catch" disabled="false" id="0c7d86a4-ff9d-4c3f-abe9-44f89cd4c94f" variable="exception">
					<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="29f6bc99e2394523932191a71d99fb50">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="df627532-ba72-4ffc-ad98-8d8996529872" serviceId="nabu.utils.Runtime.summarizeException" resultName="result6c61a1da4ba9459d9352d7d20bb5f1cc" invocationOrder="0" temporaryMapping="true" y="205" x="77">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="b6662275-9244-477c-8c34-139f1e4e3c96" fixedValue="false" optional="false" mask="false">
								<from>exception</from>
								<to>exception</to>
							</steps>
							<asynchronous>false</asynchronous>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="b427db8c-0340-4277-80bd-95850675c39b" fixedValue="false" optional="false" mask="false">
							<from>result6c61a1da4ba9459d9352d7d20bb5f1cc/summary</from>
							<to>summary</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="117293c7-ed2c-4095-9433-a21b0b9eca0f" serviceId="nabu.utils.Server.log" resultName="result54e8ace3e2ae449bbf838de4d5acd9aa" invocationOrder="0" temporaryMapping="true" y="60" x="54">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="1f1496b7-eac8-493d-8925-c7ed47e39782" fixedValue="false" optional="false" mask="false">
								<from>exception</from>
								<to>exception</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="ced14d94-72ab-4de8-9384-2345ce866c3f" fixedValue="true" optional="false" mask="false">
								<from>wtf</from>
								<to>message</to>
							</steps>
							<asynchronous>false</asynchronous>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="44f68e81-f0e8-4037-96ef-399482d5ffd7" fixedValue="true" optional="false" mask="false">
							<from>false</from>
							<to>chain</to>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Stop task and pause queue" id="2992b3a1-ff50-4fec-9a0c-f14ed34bd068">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="df24c609-b847-4ff8-ab68-764142fdeba2" serviceId="nabu.frameworks.tasks.services.task.stop" resultName="result3e64c094658c4170993ba08b8fdf589c" invocationOrder="0" temporaryMapping="true" y="67" x="68">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="f6b2d8aa-dc32-4add-88c0-4cfce5cb8ff6" fixedValue="false" optional="false" mask="false">
								<from>input/connectionId</from>
								<to>connectionId</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="bdcfccf0-ec4e-430c-ab28-ed1ad8837c7a" fixedValue="false" optional="false" mask="false">
								<from>input/task/id</from>
								<to>taskId</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="1b049081-8b15-4a89-8b27-48df14998350" fixedValue="false" optional="false" mask="false">
								<from>taskOutput</from>
								<to>taskOutput</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="3e267c8c-7b4c-4356-9ed9-a8d2a55b1c65" fixedValue="true" optional="false" mask="false">
								<from>=summary/serviceStack + "\n\n" + summary/exceptionStack</from>
								<to>errorDescription</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="f8f1799a-48a0-4634-87fc-eb8c1d7dfb2b" fixedValue="false" optional="false" mask="false">
								<from>summary/message</from>
								<to>errorMessage</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="a86b8d2c-51cf-481f-b2b3-e58404d304d1" fixedValue="false" optional="false" mask="false">
								<from>summary/code</from>
								<to>code</to>
							</steps>
							<asynchronous>false</asynchronous>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="1eb4da6d-2427-4116-9c7f-358fb7b16c0b" serviceId="nabu.frameworks.tasks.database.taskQueue.pauseQueue" resultName="result64f108a898f04ee2b4f6b060a8119aeb" invocationOrder="0" temporaryMapping="true" y="171" x="41">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="4a8e01bf-e14a-4b22-a40d-45edd4a46403" fixedValue="false" optional="false" mask="false">
								<from>input/queue/id</from>
								<to>parameters[0]/queueId</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="1e8e4f7a-8e88-4972-85ab-a6860e6f0b7c" fixedValue="false" optional="false" mask="false">
								<from>input/connectionId</from>
								<to>connection</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="ea17304c-c716-4750-b7e5-0133e9e2af13" fixedValue="false" optional="false" mask="false">
								<from>input/transactionId</from>
								<to>transaction</to>
							</steps>
							<asynchronous>false</asynchronous>
						</steps>
					</steps>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Sequence" disabled="false" label="chain" id="2a318c58-b714-4cde-ba0e-1777f96c16b4">
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Chain a new task for this queue if possible" id="42e1ba25-ab77-4491-9973-417749c0502e">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="d2cbfe59-939b-4089-9509-e79baac950d7" serviceId="nabu.frameworks.tasks.utils.queue.subscribe" resultName="result3669c172fe714379a100041bc06cbb51" invocationOrder="0" temporaryMapping="true" y="48" x="45">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="eaf10a99-22d3-462d-aecd-fd310ef82cd9" fixedValue="false" optional="false" mask="false">
							<from>input/connectionId</from>
							<to>connectionId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="0f8267c0-da11-47aa-bd1e-f26769f579b3" fixedValue="false" optional="false" mask="false">
							<from>input/transactionId</from>
							<to>transactionId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="27254feb-a6fd-4b31-b77e-75b2a72b36c7" fixedValue="false" optional="false" mask="false">
							<from>input/queue</from>
							<to>queue</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="ac0b381a-c2e1-4b23-9d7f-cb95d26fd702" fixedValue="false" optional="false" mask="false">
							<from>input/localLock</from>
							<to>localLock</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="79933069-eef7-4fb0-9929-70d1fee2bd37" fixedValue="false" optional="false" mask="false">
							<from>input/targets</from>
							<to>targets</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="c63e26cb-57db-4246-81ab-0e220daf0377" fixedValue="false" optional="false" mask="false">
							<from>input/taskType</from>
							<to>taskType</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="d1b6c0dc-9c5b-488d-bf00-a17c56a083ba" serviceId="nabu.utils.List.size" resultName="resulte2d123fda7794f349c6261a8b59e165e" invocationOrder="1" temporaryMapping="true" y="200" x="228">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="0e76a398-b4b2-46c3-930c-6f3389f1fe78" fixedValue="false" optional="false" mask="false">
							<from>result3669c172fe714379a100041bc06cbb51/tasks</from>
							<to>list</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="d7124cd3-0218-4978-820b-81c134e56c5e" fixedValue="false" optional="false" mask="false">
						<from>resulte2d123fda7794f349c6261a8b59e165e/size</from>
						<to>amountOfRescheduledTasks</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="amountOfRescheduledTasks = 0" comment="If we could not reschedule a task, check that the queue is done" id="ff922eef-773e-47ba-9935-42d653123c8e">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="c180d9f2-aa82-42db-8ea6-ee67ebedaa4b" serviceId="nabu.frameworks.tasks.utils.queue.checkFinished" resultName="result99f2059a50a8438e9f74898e759d2703" invocationOrder="0" temporaryMapping="true" y="85" x="40">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="df46096d-50f5-46d7-b7c4-bd193abcf4c2" fixedValue="false" optional="false" mask="false">
							<from>input/connectionId</from>
							<to>connectionId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="6d1df794-e37f-4ed5-8168-c2048e13a70a" fixedValue="false" optional="false" mask="false">
							<from>input/transactionId</from>
							<to>transactionId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="8de8cb92-562a-4cec-9ae0-262e6bfdd910" fixedValue="false" optional="false" mask="false">
							<from>input/queue</from>
							<to>queue</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Finally" disabled="false" id="dc1dbc5f-ba01-4c37-83e4-c97b306a3aba">
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="input/clusterLock != null" comment="Unlock cluster lock" id="04a99b93-9c23-4aba-901c-a6ea1993f360">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="716c1ca9-669f-43b0-9c5d-11eba78a6b4a" serviceId="nabu.utils.Lock.unlock" resultName="resultdabf071323e444ecbfb21af589ba1518" invocationOrder="0" temporaryMapping="true" y="85" x="49">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="4a503b5c-b602-4b89-953e-837896d30fc7" fixedValue="true" optional="false" mask="false">
							<from>false</from>
							<to>local</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="20affd66-b452-403d-b05b-b87aee9d4170" fixedValue="false" optional="false" mask="false">
							<from>input/clusterLock</from>
							<to>name</to>
						</steps>
						<asynchronous>false</asynchronous>
					</steps>
				</steps>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Finally" disabled="false" id="88331d41-bd07-46e1-bd0c-992364958161">
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Unlock locally" id="581b8a9f3a314b14be44d500d87cfb25">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="db5b7b2c3a284cff96dc422afcdabd56" serviceId="nabu.utils.Lock.unlock" resultName="resultdabf071323e444ecbfb21af589ba1518" invocationOrder="0" temporaryMapping="true" y="85" x="49">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="c2bfd20fd3d1473d973c906b0d538478" fixedValue="false" optional="false" mask="false">
						<from>input/localLock</from>
						<to>name</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="ac8c0e71abe842329e4ed257131c449f" fixedValue="true" optional="false" mask="false">
						<from>true</from>
						<to>local</to>
					</steps>
					<asynchronous>false</asynchronous>
				</steps>
			</steps>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="manage" id="f2646543-b8ab-4322-a13d-23056cbbaeac">
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="bc5c5f0e-6474-4588-aee6-14541c01669e" serviceId="nabu.utils.Transaction.commit" resultName="resultb5de570bbfa946bdbb7a796c779d9465" invocationOrder="0" temporaryMapping="true" y="66" x="66">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="d35c56ac-7739-4bf8-88b8-bb87a86cca85" fixedValue="false" optional="false" mask="false">
				<from>input/transactionId</from>
				<to>transactionId</to>
			</steps>
			<asynchronous>false</asynchronous>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Kickstart local subscriber to check once more (if not already busy)" id="a5cfc7bb-cb1c-4dba-a983-2b1aa727d8cd">
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="6390059f-a4a9-4543-a257-4d5a788ad447" serviceId="nabu.utils.Runtime.interrupt" resultName="resultc90e2d0f96484b41a6f93adfe26f5262" invocationOrder="0" temporaryMapping="true" y="125" x="40">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="2f2a93d9-a7ae-4db6-828f-e6fa30cc4f4e" fixedValue="true" optional="false" mask="false">
				<from>nabu.frameworks.tasks.artifacts.taskChecker</from>
				<to>artifactId</to>
			</steps>
			<asynchronous>false</asynchronous>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Catch" disabled="false" id="b2a455da-3c0f-4777-b462-2a2c29945b61" variable="exception">
		<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="manage" id="2b0819a8277e40df8f0faaefbb689e69">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="19411fd4-b5a0-490f-9ce4-a3abfee1158c" serviceId="nabu.utils.Transaction.rollback" resultName="result929732ee1d7445c4ac10a67717aa7017" invocationOrder="0" temporaryMapping="true" y="23" x="22">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="59dbb8cb-9569-40a3-85a4-462181040d52" fixedValue="false" optional="false" mask="false">
					<from>input/transactionId</from>
					<to>transactionId</to>
				</steps>
				<asynchronous>false</asynchronous>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Throw" disabled="false" id="3c30a983-c6ce-4d88-9a50-9e79c602483e" message="=exception" xsi:nil="true"/>
	</steps>
</sequence>